(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{367:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"cookie与session"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cookie与session"}},[s._v("#")]),s._v(" Cookie与Session")]),s._v(" "),t("h2",{attrs:{id:"一、今日学习内容与目标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、今日学习内容与目标"}},[s._v("#")]),s._v(" 一、今日学习内容与目标")]),s._v(" "),t("ul",[t("li",[s._v("理解什么是 HTTP 无状态")]),s._v(" "),t("li",[s._v("理解 HTTP 无状态带来的问题")]),s._v(" "),t("li",[s._v("掌握会话跟踪的 3 种实现方式")]),s._v(" "),t("li",[s._v("理解 Cookie 技术的原理和作用")]),s._v(" "),t("li",[s._v("掌握 Cookie 技术的基本使用")]),s._v(" "),t("li",[s._v("了解 Cookie 技术的细节操作")]),s._v(" "),t("li",[s._v("理解 Session 技术的原理和作用")]),s._v(" "),t("li",[s._v("掌握 Session 技术的基本使用")]),s._v(" "),t("li",[s._v("了解 Session 技术的细节操作")])]),s._v(" "),t("h2",{attrs:{id:"二、http-无状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、http-无状态"}},[s._v("#")]),s._v(" 二、HTTP 无状态")]),s._v(" "),t("h3",{attrs:{id:"_2-1-问题说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-问题说明"}},[s._v("#")]),s._v(" 2.1 问题说明")]),s._v(" "),t("p",[s._v("HTTP 协议是无状态的，也就是没有记忆力，也无法确定发出请求的用户身份。只负责一问一答。")]),s._v(" "),t("p",[t("strong",[s._v("问题")]),s._v("： 一个会话中的多个请求之间无法共享数据。")]),s._v(" "),t("p",[s._v("如 : 在操作邮箱的过程中，我们有下面的需求")]),s._v(" "),t("ol",[t("li",[s._v("用户访问登录页面，填写账号密码完成登录验证")]),s._v(" "),t("li",[s._v("如果验证通过，页面跳转到邮箱首页，显示"),t("strong",[s._v("当前用户名")]),s._v("。")]),s._v(" "),t("li",[s._v("用户点击收件箱，显示"),t("strong",[s._v("当前用户的邮件列表")]),s._v("，显示登陆的"),t("strong",[s._v("用户名")])]),s._v(" "),t("li",[s._v("查看其中一封邮件的内容，显示登陆的"),t("strong",[s._v("用户名")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20200516232518539.png",alt:"image-20200516232518539"}})]),s._v(" "),t("p",[s._v("②③ 请求的请求对象（req）是各自的，都没有①请求的数据（用户登陆信息），故①②③请求的 req 都是各自的，无法共享数据。而 "),t("strong",[s._v("实际开发中,我们需要在多个请求之间来共享数据")])]),s._v(" "),t("p",[t("strong",[s._v("解决方案")]),s._v("： 借助其他方式或技术来实现会话中多个请求间数据的共享")]),s._v(" "),t("p",[t("strong",[s._v("传参方式")]),s._v("：直接在路径上带参数（麻烦且数据不安全，不使用）")]),s._v(" "),t("p",[t("strong",[s._v("会话跟踪技术")]),s._v("： 推荐")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("Cookie 客户端会话跟踪技术")])]),s._v(" "),t("li",[t("p",[s._v("Session 服务端会话跟踪技术(HttpSession)")])])]),s._v(" "),t("h3",{attrs:{id:"_2-2-邮箱案例实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-邮箱案例实现"}},[s._v("#")]),s._v(" 2.2 邮箱案例实现")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("登录页面 \t登陆---\x3e 处理登录请求（LoginServlet.java）")]),s._v(" "),t("div",{staticClass:"language-jsp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<h3>用户登录</h3>\n<form action="/http/login" method="post">\n    <p>账号：<input type="text" name="username"></p>\n    <p>密码：<input type="text" name="password"></p>\n    <input type="submit" value="登录">\n</form>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("LoginServlet.java  ---\x3e 跳转到首页（index.jsp）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletResponse")]),s._v(" resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 处理请求编码")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCharacterEncoding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UTF-8"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1 接受请求参数，封装成对象")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" password "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2 调用业务方法来处理请求,模拟和数据中账号信息的匹配")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 模拟登录成功，跳转到主页面")]),s._v("\n        req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAttribute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3 控制跳转")]),s._v("\n        req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequestDispatcher")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/WEB-INF/views/index.jsp"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("forward")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"登录失败"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("主页（index.jsp）点击查看收件箱 ---\x3e（ListServlet.java）")]),s._v(" "),t("div",{staticClass:"language-jsp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('    欢迎: ${username} <br/>\n    <a href="/http/list">收件箱</a>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("ListServlet.java  ---\x3e 跳转到邮件列表页（list.jsp）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletResponse")]),s._v(" resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1 接受请求参数,封装成对象")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2 调用业务方法来处理请求,从数据库中查询邮件列表(模拟)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"邮件1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"邮件2"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"邮件3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAttribute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"list"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAttribute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequestDispatcher")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/WEB-INF/views/list.jsp"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("forward")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("邮件列表页（list.jsp）---\x3e 查看邮件内容（ContentServlet.java）")]),s._v(" "),t("div",{staticClass:"language-jsp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('欢迎:${username} <br/>\n<c:forEach items="${list}" var="email">\n    <a href="/http/content">${email}</a> <br/>\n</c:forEach>\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("ContentServlet.java ---\x3e 跳转到邮件内容页（content.jsp）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletResponse")]),s._v(" resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1 接受请求参数,封装成对象")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAttribute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 模拟从数据库中查询到邮件内容")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAttribute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"content"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"这是邮件内容"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequestDispatcher")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/WEB-INF/views/content.jsp"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("forward")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("邮件内容页（content.jsp）")]),s._v(" "),t("div",{staticClass:"language-jsp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("欢迎: ${username}<br/>\n${content}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("h2",{attrs:{id:"三、cookie"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、cookie"}},[s._v("#")]),s._v(" 三、Cookie")]),s._v(" "),t("h3",{attrs:{id:"_3-1-cookie-概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-cookie-概述"}},[s._v("#")]),s._v(" 3.1 Cookie 概述")]),s._v(" "),t("p",[s._v("Cookie是 "),t("strong",[s._v("客户端技术")]),s._v("，程序把每个用户的数据以 cookie 的形式写给用户各自的浏览器。当用户使用浏览器再次去访问服务器中的 web 资源时，就会带着各自的 cookie 过去服务器。这样, web 资源处理的就是用户各自的数据了。")]),s._v(" "),t("p",[t("strong",[s._v("思考")]),s._v("：")]),s._v(" "),t("ol",[t("li",[s._v("Cookie 是服务器端创建的还是客户创建的？ 服务器端程序创建")]),s._v(" "),t("li",[s._v("Cookie 从哪里带到哪里？服务器端  -> 客户端")]),s._v(" "),t("li",[s._v("Cookie 最终存在什么地方？ 浏览器")]),s._v(" "),t("li",[s._v("Cookie 什么时候实现数据共享？ 再一次访问服务器端资源时(存入,拿出)")]),s._v(" "),t("li",[s._v("Cookie 中数据的传递方向？ 浏览器 -> 服务器 (Cookie)-> 浏览器(存入) ->服务器(获取Cookie数据)")])]),s._v(" "),t("h3",{attrs:{id:"_3-2-cookie-原理图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-cookie-原理图"}},[s._v("#")]),s._v(" 3.2 Cookie 原理图")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20200517002505388.png",alt:"image-20200517002505388"}})]),s._v(" "),t("h3",{attrs:{id:"_3-3-cookie-基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-cookie-基本使用"}},[s._v("#")]),s._v(" 3.3 Cookie 基本使用")]),s._v(" "),t("p",[s._v("Cookie 的基本使用无非是")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("如何在服务器端创建Cookie？")])]),s._v(" "),t("li",[t("p",[s._v("如何发送 Cookie 给浏览器？")])]),s._v(" "),t("li",[t("p",[s._v("如何获取浏览器带过来的 Cookie？04")])])]),s._v(" "),t("h4",{attrs:{id:"_3-3-1-创建-cookie-对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-创建-cookie-对象"}},[s._v("#")]),s._v(" 3.3.1 创建 Cookie 对象")]),s._v(" "),t("p",[s._v("创建对象： Cookie  cookie = new Cookie (String name,String value)")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("属性")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("方法")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("描述")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("name")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("getName()")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("共享数据名称（唯一）")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("value")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("getValue()")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("要共享的数据")])])])]),s._v(" "),t("h4",{attrs:{id:"_3-3-2-响应-cookie-给浏览器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-响应-cookie-给浏览器"}},[s._v("#")]),s._v(" 3.3.2 响应 Cookie 给浏览器")]),s._v(" "),t("p",[s._v("使用响应对象中的 addCookie (cookie 对象) 将数据响应给浏览器.")]),s._v(" "),t("blockquote",[t("p",[s._v("resp.addCookie(cookie)")])]),s._v(" "),t("h4",{attrs:{id:"_3-3-3-服务器端获取-cookie"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-服务器端获取-cookie"}},[s._v("#")]),s._v(" 3.3.3 服务器端获取 Cookie")]),s._v(" "),t("p",[s._v("浏览器发请求时,自动将 Cookie 发送到服务器,服务器程序直接获取即可。")]),s._v(" "),t("p",[s._v("数据在请求中，使用请求对象中的 getCookies() 方法获取所有的 Cookie 对象")]),s._v(" "),t("blockquote",[t("p",[s._v("Cookie[] cs = request对象.getCookies();")])]),s._v(" "),t("h4",{attrs:{id:"_3-3-4-案例代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-4-案例代码"}},[s._v("#")]),s._v(" 3.3.4 案例代码")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("创建 Cookie 响应给浏览器 （LoginServlet）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletResponse")]),s._v(" resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ServletException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setCharacterEncoding")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UTF-8"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" password "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//**** 把数据存入 Cookie 中,写给浏览器 **** ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),s._v(" cookie "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//**** 把 Cookie 写个浏览器 **** ")]),s._v("\n        resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("addCookie")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cookie"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 模拟登录成功，跳转到主页面")]),s._v("\n        req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setAttribute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getRequestDispatcher")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/WEB-INF/views/index.jsp"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("forward")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("resp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"登录失败"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("从 Cookie 中获取数据（其他 Servlet 或 JSP）")]),s._v(" "),t("p",[s._v("Servlet 获取方式")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取浏览器带过来的 Cookie 数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" cs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCookies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),s._v(" cookie "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" cs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cookie"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     username "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cookie"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("JSP 获取方式 cookie 集合中 key 为 username 的 cookie 的 value")]),s._v(" "),t("div",{staticClass:"language-jsp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<%\n    String username = null;\n    Cookie[] cs = request.getCookies();\n    for(Cookie cookie : cs){\n        if("username".equals(cookie.getName())){\n            username = cookie.getValue();\n        }\n    }\n%>    \n脚本方式:<%=username%> <br/>\n\x3c!-- *** 推荐使用以下方式 *** --\x3e\nEL 内置对象方式: ${cookie.username.value}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"_3-4-cookie-细节使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-cookie-细节使用"}},[s._v("#")]),s._v(" 3.4 Cookie 细节使用")]),s._v(" "),t("h4",{attrs:{id:"_3-4-1-修改-cookie-中的数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-1-修改-cookie-中的数据"}},[s._v("#")]),s._v(" 3.4.1 修改 Cookie 中的数据")]),s._v(" "),t("p",[s._v("为 Cookie 重新设置数据")]),s._v(" "),t("ol",[t("li",[s._v("调用 cookie 对象的 "),t("strong",[s._v("setValue")]),s._v(" 方法来覆盖原本的数据")]),s._v(" "),t("li",[s._v("重"),t("strong",[s._v("新")]),s._v("创建一个同 name 的 "),t("strong",[s._v("Cookie 对象")])])]),s._v(" "),t("p",[s._v("以上不管使用哪种方式，修改的都是服务器端内存中的 Cookie 数据，和浏览器中存的 Cookie 没有关系，所以需要重新发送新的 Cookie 到浏览器中进行更新。")]),s._v(" "),t("p",[t("strong",[s._v("注意： 需要将修改之后的 Cookie 发送到浏览器中进行更新")])]),s._v(" "),t("blockquote",[t("p",[s._v("resp.addCookie(新的 cookie 对象)")])]),s._v(" "),t("h4",{attrs:{id:"_3-4-2-设置-cookie-存活时间-掌握"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-2-设置-cookie-存活时间-掌握"}},[s._v("#")]),s._v(" 3.4.2 设置 Cookie 存活时间(掌握)")]),s._v(" "),t("p",[s._v("默认情况下 Cookie 属于会话 Cookie ，即浏览器关闭则失效，无法使用。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20200517011232287.png",alt:"image-20200517011232287"}}),t("br")]),s._v(" "),t("p",[s._v("要实现以上功能则需要在创建 Cookie之后给 Cookie 设置存活时间。")]),s._v(" "),t("p",[t("strong",[s._v("API")]),s._v("：Cookie 对象的 setMaxAge(int expiry)")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("expiry数值")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("例子")]),s._v(" "),t("th",[s._v("含义")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("大于 0 的数值")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("setMaxAge(60)")]),s._v(" "),t("td",[s._v("Cookie 存活的时间，单位为秒，例：60秒")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("0")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("setMaxAge(0)")]),s._v(" "),t("td",[s._v("立即删除当前 Cookie 对象")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("小于 0 的数值")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("setMaxAge(-1)")]),s._v(" "),t("td",[s._v("会话 Cookie，浏览器关闭则销毁")])])])]),s._v(" "),t("h4",{attrs:{id:"_3-4-3-删除-cookie"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-3-删除-cookie"}},[s._v("#")]),s._v(" 3.4.3 删除 Cookie")]),s._v(" "),t("p",[s._v("删除 Cookie 只需要使用设置Cookie 存活时间的方法即可，当然需要注意的是一般是中途删除 Cookie ，不是 创建了马上删除，所以在设置删除之后需要重新发送给浏览器去更新删除。")]),s._v(" "),t("p",[s._v("API**：")]),s._v(" "),t("p",[s._v("Cookie 对象.setMaxAge(0);\nresponse.addCookie(Cookie对象);")]),s._v(" "),t("h4",{attrs:{id:"_3-3-4-cookie-中文问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-4-cookie-中文问题"}},[s._v("#")]),s._v(" 3.3.4 Cookie 中文问题")]),s._v(" "),t("p",[s._v("Cookie 中的 name 属性和 value 都不支持中文,如果有中文,抛以下异常  (Tomcat8.5 以下存在的问题)")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20200517012247240.png",alt:"image-20200517012247240"}})]),s._v(" "),t("p",[s._v("Tomcat8.5 自动处理了 Cookie 中文问题，所以无需手动解决。")]),s._v(" "),t("p",[t("strong",[s._v("Tomcat 8.5 以下解决思路")]),s._v("： 将中文进行处理,转换成另一种非中文字符串，获取时转化回来。")]),s._v(" "),t("p",[t("strong",[s._v("API")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("类")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("方法")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("作用")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("URLEncoder")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("encode(“中文”,“UTF-8”)")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("把中文字符串转化为非中文")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("URLDecoder")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("decode（“非中文”，“UTF-8”）")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("把非中文转化为中文")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("小狼   <===>    %E5%B0%8F%E7%8B%BC")])]),s._v(" "),t("p",[t("strong",[s._v("Cookie 使用")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Cookie 封装数据方式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),s._v(" cookie "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"USER_IN_COOKIE"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("URLEncoder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("encode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"小狼"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UTF-8"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Cookie 获取数据方式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" cs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getCookies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cookie")]),s._v(" c "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" cs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("equals")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("URLDecoder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("decode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UTF-8"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h3",{attrs:{id:"_3-5-cookie-的域和路径-了解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-cookie-的域和路径-了解"}},[s._v("#")]),s._v(" 3.5 Cookie 的域和路径（了解）")]),s._v(" "),t("p",[s._v("为了让浏览器可以设别 Cookie 发送给对应的服务器，以及设别哪些请求需要带 Cookie，默认 Cookie 都带了服务器的设别标识以及需要带 Cookie 的资源标识。")]),s._v(" "),t("p",[t("strong",[s._v("设别服务器")]),s._v("： IP:端口,可设别到服务器，但需要两个数据，域名是 IP:端口 整合，所以使用 "),t("strong",[s._v("域名")]),s._v("，只能是创建Cookie 的服务器的域名。")]),s._v(" "),t("p",[t("strong",[s._v("域名分类")]),s._v("：")]),s._v(" "),t("ul",[t("li",[s._v("一级（主）域名：baidu.com")]),s._v(" "),t("li",[s._v("多级域名：news."),t("strong",[s._v("baidu.com")])])]),s._v(" "),t("p",[s._v("想要在相同的主域名下来共享数据，例如，百度和百度地图，百度音乐共用账号，则只需要设置 Cookie 的 domain 即可。主域不同，无法共享数据。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("cookie"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setDomain")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".baidu.com"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("设别资源")]),s._v("： 使用"),t("strong",[s._v("路径 path")]),s._v("，默认为创建 Cookie的资源所在目录。例：/cookie/login 创建 Cookie，则path为/cookie,则访问 /cookie 打头的资源都会带上该 Cookie。")]),s._v(" "),t("p",[s._v("想要在访问服务器上的任意资源都带上 Cookie ，则只需要在创建 Cookie 之后设置下path 为 / 即可。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("cookie"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setPath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("注意")]),s._v("：")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("主域名不同，不管 path 为啥，都无法带上 Cookie")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("localhost/login 中创建的 Cookie，path 也为 /，则任意资源访问都会带该 Cookie")])])])]),s._v(" "),t("h3",{attrs:{id:"_3-6-cookie-的小问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-cookie-的小问题"}},[s._v("#")]),s._v(" 3.6 Cookie 的小问题")]),s._v(" "),t("ol",[t("li",[s._v("如果是一个用户一台电脑,没有问题,但是如果多个人公用一个电脑就存在,不安全")]),s._v(" "),t("li",[s._v("使用中文的 (Tomcat8.5 之内) 比较麻烦(编码,解码)")]),s._v(" "),t("li",[s._v("一个 Cookie 只能设置一个值,value 是 String 类型")]),s._v(" "),t("li",[s._v("一台服务器在一个客户端存储的 Cookie 大小和数量有限\nCookie 大小限制在 4KB 之内；\n一台服务器在一个客户端最多保存 20 个 Cookie；\n一个浏览器最多可以保存 300 个 Cookie；")])]),s._v(" "),t("h2",{attrs:{id:"四、session"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、session"}},[s._v("#")]),s._v(" 四、Session")]),s._v(" "),t("h4",{attrs:{id:"_4-1-session-概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-session-概述"}},[s._v("#")]),s._v(" 4.1 Session 概述")]),s._v(" "),t("p",[s._v("Session是"),t("strong",[s._v("服务器端技术")]),s._v("，利用这个技术，服务器在运行时可以为每一个 "),t("strong",[s._v("用户的浏览器")]),s._v(" 创建一个其"),t("strong",[s._v("独享的session对象")]),s._v("，由于session为用户浏览器独享，所以用户在访问服务器的 web 资源时，可以把各自的数据放在各自的session中，当用户再去访问服务器中的其它 web 资源时，其它 web 资源再从用户各自的 session 中取出数据为用户服务。")]),s._v(" "),t("p",[t("strong",[s._v("思考")]),s._v("：")]),s._v(" "),t("ol",[t("li",[s._v("Session 谁来创建？ 服务器")]),s._v(" "),t("li",[s._v("Session 存在什么地方？ 服务器")]),s._v(" "),t("li",[s._v("Session 什么时候实现数据共享？ 再一次访问服务器端资源时(存入,取出)")]),s._v(" "),t("li",[s._v("Session 中数据的传递方向？ 浏览器 -> 服务器(Session)  -> 服务器资源")]),s._v(" "),t("li",[s._v("服务器如何设别不同用户的 Session？ 浏览器 -> 服务器(Session)  sessionId -> 浏览器 sessionId -> 服务器")])]),s._v(" "),t("h4",{attrs:{id:"_4-2-session-的原理图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-session-的原理图"}},[s._v("#")]),s._v(" 4.2 Session 的原理图")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20200517080220879.png",alt:"image-20200517080220879"}})]),s._v(" "),t("p",[s._v("Session 其底层任然需要依赖Cookie 来传递 Session 的id 值。传递 sessionId 的 Cookie 为会话 Cookie。")]),s._v(" "),t("p",[s._v("所以 Session 在浏览器关闭之后就无法使用了。原因是 sessionId 丢失了，服务器会在 30 分钟内清除未有操作的Session 对象。")]),s._v(" "),t("h4",{attrs:{id:"_4-3-session-的基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-session-的基本使用"}},[s._v("#")]),s._v(" 4.3 Session 的基本使用")]),s._v(" "),t("p",[s._v("Sessioon 的基本使用无非是如何得到 Session 对象以及如何做数据的共享")]),s._v(" "),t("h5",{attrs:{id:"_4-3-1-获取-session-对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-获取-session-对象"}},[s._v("#")]),s._v(" 4.3.1 获取 Session 对象")]),s._v(" "),t("p",[s._v("获取 Session 使用 HttpServletRequest 的 API")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("方法")]),s._v(" "),t("th",[s._v("作用")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("getSession(true)")]),s._v(" "),t("td",[s._v("判断是否存在 Session ,存在则获取,不存在则创建新 Session 对象返回")])]),s._v(" "),t("tr",[t("td",[s._v("getSession(false)")]),s._v(" "),t("td",[s._v("判断是否存在 Session ,存在则获取,不存在则返回 null （不符合需求）")])]),s._v(" "),t("tr",[t("td",[s._v("getSession()")]),s._v(" "),t("td",[s._v("判断是否存在 Session (浏览器是否带了sessionId),存在则获取,不存在则创建新 Session 对象返回 （推荐）")])])])]),s._v(" "),t("p",[s._v("推荐使用 getSession () 满足需求的同时比较简洁")]),s._v(" "),t("h5",{attrs:{id:"_4-3-2-session-数据共享"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-session-数据共享"}},[s._v("#")]),s._v(" 4.3.2 Session 数据共享")]),s._v(" "),t("p",[s._v("HttpSession API")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("方法")]),s._v(" "),t("th",[s._v("作用")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("setAttribute(String name, Object value)")]),s._v(" "),t("td",[s._v("设置属性名和属性值")])]),s._v(" "),t("tr",[t("td",[s._v("getAttribute(String name)")]),s._v(" "),t("td",[s._v("通过属性名去获取属性值")])]),s._v(" "),t("tr",[t("td",[s._v("removeAttribute(String name)")]),s._v(" "),t("td",[s._v("从Session中移除指定属性名的属性值")])]),s._v(" "),t("tr",[t("td",[s._v("invalidate()")]),s._v(" "),t("td",[s._v("移除整个Session 对象,删除所有的属性和属性值")])])])]),s._v(" "),t("p",[s._v("removeAttribute 和 invalidate 视情况选择，一般使用 removeAttribute，避免删除session 对象之后有的数据任然需要使用。")]),s._v(" "),t("h4",{attrs:{id:"_4-4-session-的细节使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-session-的细节使用"}},[s._v("#")]),s._v(" 4.4 Session 的细节使用")]),s._v(" "),t("h5",{attrs:{id:"_4-4-1-session-超时管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-1-session-超时管理"}},[s._v("#")]),s._v(" 4.4.1 Session 超时管理")]),s._v(" "),t("p",[s._v("设置会话的有效时间，比如金融项目，一般用户登陆状态只保留1~3分钟，不会一直保留。中途离开，回来需要重新登陆。")]),s._v(" "),t("blockquote",[t("p",[s._v("session对象.setMaxInactiveInterval(int interval) : 设置session超时时间(秒)(两次请求之间的时间)")])]),s._v(" "),t("p",[s._v("Tomcat 默认是 30 分钟,实际上只保存20来分钟(web.xml)")]),s._v(" "),t("img",{staticStyle:{zoom:"100%"},attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20200517084400842.png",align:"left",alt:"image-20200517084400842"}}),s._v(" "),t("h5",{attrs:{id:"_4-4-2-url-重写"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-2-url-重写"}},[s._v("#")]),s._v(" 4.4.2 URL 重写")]),s._v(" "),t("p",[s._v("Session 是一个特殊的 Cookie,存在浏览器上,用户可选择不接受 Cookie，此时Session 失效。")]),s._v(" "),t("p",[t("strong",[s._v("解决方案")]),s._v("：")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("手动在请求url后面拼接jsessionid,使用 "),t("strong",[s._v(";")]),s._v(" 来间隔")]),s._v(" "),t("p",[s._v("http://localhost/session/list;jsessionid=6225FDD3988C3B11BD8320899E9B1D2F")])]),s._v(" "),t("li",[t("p",[s._v("自动在请求的URL后面拼接 jsessionid  (自动检测用户是否开启Cookie接收,如果开启了,则不拼接jsessionid)")]),s._v(" "),t("p",[s._v('response对象.encodeURL("/session/content") ;')])])]),s._v(" "),t("p",[t("strong",[s._v("JSP")]),s._v("：")]),s._v(" "),t("p",[s._v("脚本获取")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" url "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("encodeURL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/session/list"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("a href"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<%=url%>"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("收件箱"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("EL 获取")])]),s._v(" "),t("div",{staticClass:"language-jsp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('${pageContext.response.encodeURL("/session/content")}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("注意： 一般开发中不去屏蔽Cookie ,一般用户也不会去做")])]),s._v(" "),t("h4",{attrs:{id:"_4-5-session-使用规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-session-使用规范"}},[s._v("#")]),s._v(" 4.5 Session 使用规范")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("Session 的属性命名,一般我们命名: XX_IN_SESSION ,而且这个属性名是唯一的")]),s._v(" "),t("strong",[s._v("session.setAttribute(“USER_IN_SESSION”,user);")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Session 可以存放多个数据，但是如果数据之间是有联系的，比如username,password 需要封装起来再存入 User(username,password)")])])]),s._v(" "),t("li",[t("p",[s._v("服务器在做 session 数据共享时,session 中的对象类型必须实现 java.io.Serializable; 接口(在网络上传递数据). (了解)\n序  列  化: 把对象转成二进制\n反序列化: 把二进制恢复成对象")])])]),s._v(" "),t("h2",{attrs:{id:"五、小结与作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、小结与作业"}},[s._v("#")]),s._v(" 五、小结与作业")]),s._v(" "),t("h3",{attrs:{id:"_5-1-小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-小结"}},[s._v("#")]),s._v(" 5.1 小结")]),s._v(" "),t("ul",[t("li",[s._v("理解什么是 HTTP 无状态")]),s._v(" "),t("li",[s._v("理解 HTTP 无状态带来的问题")]),s._v(" "),t("li",[s._v("掌握会话跟踪的 3 种实现方式")]),s._v(" "),t("li",[s._v("理解 Cookie 技术的原理和作用")]),s._v(" "),t("li",[s._v("掌握 Cookie 技术的基本使用(写代码)")]),s._v(" "),t("li",[s._v("了解 Cookie 技术的细节操作")]),s._v(" "),t("li",[s._v("理解 Session 技术的原理和作用")]),s._v(" "),t("li",[s._v("掌握 Session 技术的基本使用 (写代码)")]),s._v(" "),t("li",[s._v("了解 Session 技术的细节操作")])]),s._v(" "),t("h3",{attrs:{id:"_5-2-作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-作业"}},[s._v("#")]),s._v(" 5.2 作业")]),s._v(" "),t("ul",[t("li",[s._v("实现邮箱功能的模拟，演示 HTTP 无状态的效果")]),s._v(" "),t("li",[s._v("使用 Cookie 技术来解决 Http 无状态带来的问题")]),s._v(" "),t("li",[s._v("使用 Session 技术来解决 Http 无状态带来的问题")]),s._v(" "),t("li",[s._v("书写代码练习 Cookie 和 Session  的细节操作（过一下保留印象就可以）")]),s._v(" "),t("li",[s._v("拓展：完成购物车的记录（用户没登录的情况，用户登录的情况）")])])])}),[],!1,null,null,null);t.default=e.exports}}]);