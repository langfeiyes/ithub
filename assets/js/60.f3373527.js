(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{385:function(s,t,a){"use strict";a.r(t);var e=a(4),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[s._v("#")]),s._v(" Redis")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/redis.jpg",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"一、今日学习内容与目标"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、今日学习内容与目标"}},[s._v("#")]),s._v(" 一、今日学习内容与目标")]),s._v(" "),t("p",[s._v("1>了解NoSQL概念")]),s._v(" "),t("p",[s._v("2>了解Redis概念，定位，优点，缺点")]),s._v(" "),t("p",[s._v("3>掌握Redis常用五大类型")]),s._v(" "),t("p",[s._v("4>掌握Redis Key 与Value值设计")]),s._v(" "),t("p",[s._v("5>掌握Redis全局命令")]),s._v(" "),t("p",[s._v("6>掌握Redis 安全与事务操作")]),s._v(" "),t("p",[s._v("7>了解Redis持久化策略")]),s._v(" "),t("p",[s._v("8>了解Redis内存淘汰机制与过期Key清理")]),s._v(" "),t("p",[s._v("9>掌握Java集成Redis操作")]),s._v(" "),t("p",[s._v("10>完成综合案例设计与实现")]),s._v(" "),t("h2",{attrs:{id:"二、认识-redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、认识-redis"}},[s._v("#")]),s._v(" 二、认识 Redis")]),s._v(" "),t("p",[t("strong",[s._v("Redis（Remote Dictionary Server）")]),s._v(" 是一个开源的、内存中的数据结构存储系统，也可以被视为高性能的键值存储的NoSQL数据库。")]),s._v(" "),t("h3",{attrs:{id:"_2-1-数据库分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-数据库分类"}},[s._v("#")]),s._v(" 2.1 数据库分类")]),s._v(" "),t("ul",[t("li",[s._v("关系型数据库（RDBMS）\n"),t("ul",[t("li",[s._v("常用关系型数据库: Oracle，"),t("strong",[s._v("MySQL")]),s._v("，SqlServer，DB2")]),s._v(" "),t("li",[s._v("特点\n"),t("ul",[t("li",[s._v("数据存储在表格中，表格具有固定的列和行")]),s._v(" "),t("li",[s._v("通常使用 SQL 作为查询语言")]),s._v(" "),t("li",[s._v("具有强大的事务支持，保证数据的一致性")])])]),s._v(" "),t("li",[s._v("适用场景: 适用于需要复杂的关联查询和事务处理的应用场景")])])]),s._v(" "),t("li",[s._v("非关系型数据库（NoSQL）\n"),t("ul",[t("li",[s._v("常用的非关系数据库: "),t("strong",[s._v("Redis")]),s._v("，MongoDB，ElasticSearch， Hbase，Neo4j")]),s._v(" "),t("li",[s._v("特点:\n"),t("ul",[t("li",[s._v("数据以灵活的方式存储，可以是键值对、文档、列族、图等形式")]),s._v(" "),t("li",[s._v("NoSQL 数据库通常有自己的查询语言，不一定使用 SQL")]),s._v(" "),t("li",[s._v("对事务的支持可能相对较弱，允许在一定程度上放宽一致性要求，提高性能。")])])]),s._v(" "),t("li",[s._v("适用场景: 适用于需要处理大量非结构化或半结构化数据、对性能要求较高的应用场景")])])])]),s._v(" "),t("h3",{attrs:{id:"_2-2-为什么诞生nosql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-为什么诞生nosql"}},[s._v("#")]),s._v(" 2.2 为什么诞生NoSQL")]),s._v(" "),t("p",[s._v("随着互联网 web2.0 网站的兴起，非关系型的数据库现在成了一个极其热门的新领域，系数据库产品的发展非常迅速，而传统的关系型数据库在应付 web2.0 网站，特别是超大规 模和高并发的 SNS 类型的 web2.0 纯动态网站已经显得力不从心，暴露了很多难以克服的问题，比如高并发-高效率-高扩展")]),s._v(" "),t("p",[t("strong",[s._v("1 、 Highperformance- 对数据库高并发读写的需求")])]),s._v(" "),t("p",[s._v("web2.0 网站要根据用户个性化信息来实时生成动态页面和提供动态信息，所以基本上无法使用动态页面静态化技术，因此数据库并发负载非常高，往往要达到每秒上万次读写请求。关系型数据库应付上万次 SQL 查询还勉强顶得住，但是应付上万次 SQL 写数据请求，硬盘IO 就已经无法承受了，其实对于普通的 BS 网站，往往也存在对高并发写请求的需求。")]),s._v(" "),t("p",[t("strong",[s._v("2 、HugeStorage- 对海量数据的高效率存储和访问的需求")])]),s._v(" "),t("p",[s._v("对于大型的 SNS 网站，每天用户产生海量的用户动态信息，以国外的 Friend feed 为例，一个月就达到了 2.5 亿条用户动态，对于关系数据库来说，在一张 2.5 亿条记录的表里面进行SQL 查询，效率是极其低下乃至不可忍受的。再例如大型 web 网站的用户登录系统，例如腾讯，盛大，动辄数以亿计的帐号，关系数据库也很难应付。")]),s._v(" "),t("p",[t("strong",[s._v("3、HighScalability&&HighAvailability- 对数据库的高可扩展性和高可用性的需求")])]),s._v(" "),t("p",[s._v("在基于 web 的架构当中，数据库是最难进行横向扩展的，当一个应用系统的用户量和访问量与日俱增的时候，你的数据库却没有办法像 Web server 和 App server 那样简单的通过添加更多的硬件和服务节点来扩展性能和负载能力。对于很多需要提供 24 小时不间断服务的网站来说，对数据库系统进行升级和扩展是非常痛苦的事情，往往需要停机维护和数据迁移，可是停机维护随之带来的就是公司收入的减少")]),s._v(" "),t("h3",{attrs:{id:"_2-3-什么是redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-什么是redis"}},[s._v("#")]),s._v(" 2.3 什么是Redis")]),s._v(" "),t("p",[s._v("Redis是以key-value形式存储,和传统的关系型数据库不一样.不一定遵循传统数据库的一些基本要求")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("优点:")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("快速的读写速度")]),s._v(": Redis 将数据存储在内存中，因此具有非常快速的读写速度。内存中的存储和高效的数据结构使得 Redis 能够在毫秒级别提供响应，下面是官方的bench-mark数据：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("测试完成了50个并发执行100000个请求。\n设置和获取的值是一个256字节字符串。\nLinux box是运行Linux 2.6,这是X3320 Xeon 2.5 ghz。\n文本执行使用loopback接口(127.0.0.1)。\n结果:读的速度是110000次/s,写的速度是81000次/s \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("单线程模型")]),s._v("：Redis 使用单线程来处理命令，这使得它能够避免锁的竞争和上下文切换的开销。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("支持多种数据结构")]),s._v("：Redis 支持多种数据结构，如字符串、哈希表、列表、集合和有序集合等。这样的灵活性使得开发者可以根据应用场景选择合适的数据结构，提高了数据处理的效率。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("持久化和复制")]),s._v("：Redis 提供多种持久化选项，如 RDB 持久化和 AOF 持久化，以及主从复制机制，支持数据的持久性和可靠性。")])])])]),s._v(" "),t("li",[t("p",[s._v("缺点:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("内存占用")]),s._v(": 为 Redis 数据存储在内存中，对于大规模数据集，可能需要较大的内存空间。")]),s._v(" "),t("li",[t("strong",[s._v("不适合复杂查询")]),s._v(": Redis 不支持复杂的查询语言，适用于简单的键值对操作，但不适用于复杂查询和关系型数据库的联结操作。")])])])]),s._v(" "),t("h3",{attrs:{id:"_2-4-谁在使用redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-谁在使用redis"}},[s._v("#")]),s._v(" 2.4 谁在使用Redis")]),s._v(" "),t("p",[t("strong",[s._v("比较著名的公司有：")])]),s._v(" "),t("ul",[t("li",[s._v("github (全球最大的代码托管平台)")]),s._v(" "),t("li",[s._v("blizzard (暴雪娱乐)")]),s._v(" "),t("li",[s._v("stackoverflow (全球IT技术问答平台)")]),s._v(" "),t("li",[s._v("flickr（雅虎旗下图片分享网站）")])]),s._v(" "),t("p",[t("strong",[s._v("国内:")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("新浪微博")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("新浪微博拥有全球最大的Redis集群【2017】\n2200+亿commands/day 5000亿Read/day 500亿Write/day\n18TB+ Memory\n500+ Servers in 6 IDC 2000+instances\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("淘宝")])]),s._v(" "),t("li",[t("p",[s._v("字节跳动")])]),s._v(" "),t("li",[t("p",[s._v("美团")])])]),s._v(" "),t("h3",{attrs:{id:"_2-5-redis学习网站"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-redis学习网站"}},[s._v("#")]),s._v(" 2.5 Redis学习网站")]),s._v(" "),t("p",[s._v("Redis在线入门 ： http://try.redis.io/")]),s._v(" "),t("p",[s._v("Redis 中文资料站： http://www.redis.cn/")]),s._v(" "),t("p",[s._v("Redis 教程 : https://www.runoob.com/redis/redis-tutorial.html")]),s._v(" "),t("p",[s._v("Redis 命令参考 : http://doc.redisfans.com/")]),s._v(" "),t("h3",{attrs:{id:"_2-6-redis安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-redis安装"}},[s._v("#")]),s._v(" 2.6 Redis安装")]),s._v(" "),t("p",[s._v("Redis是使用C写的程序，目前主流在Linux操作系统，官方不提供Window版，最新的Redis版：Redis7.x")]),s._v(" "),t("p",[s._v("官网下载：https://Redis.io/download/")]),s._v(" "),t("p",[s._v("Redis 的Window版是微软公司自行移植的，目前最新版：Redis-x64-5.0.14.1.msi")]),s._v(" "),t("p",[s._v("window版：https://github.com/tporadowski/redis/releases")]),s._v(" "),t("p",[s._v("由于我们还没有讲Linux，所以我们暂时安装Window版本的.")]),s._v(" "),t("p",[s._v("注意事项:")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111104913486.png",alt:""}})])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111105032373.png",alt:""}})]),s._v(" "),t("p",[s._v("验证是否安装成功 win+R 打开运行窗口,输入redis-cli")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111105206534.png",alt:""}})])]),s._v(" "),t("p",[s._v("出现如下界面说明安装成功:")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111105251367.png",alt:""}})])]),s._v(" "),t("h2",{attrs:{id:"三、redis初体验"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、redis初体验"}},[s._v("#")]),s._v(" 三、Redis初体验")]),s._v(" "),t("p",[s._v("我们今天主要学习Redis的命令行操作，熟悉常用的数据结构之后。我们在后续的项目会使用Java的客户端连接Redis（通过框架提供的方法操作Redis命令进行存取操作）进行相关业务逻辑处理。")]),s._v(" "),t("h3",{attrs:{id:"_3-1-入门案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-入门案例"}},[s._v("#")]),s._v(" 3.1 入门案例")]),s._v(" "),t("p",[s._v("大家可以简单理解Redis就是一个非常大的Map，那么我们需要操作它就需要有"),t("strong",[s._v("key")]),s._v("和"),t("strong",[s._v("value")]),s._v("，我们对于Redis的操作主要就是"),t("strong",[s._v("存数据")]),s._v("和"),t("strong",[s._v("取数据")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看Redis中目前都有哪些Key")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" keys *\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("empty list or "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 往Redis中存储key=name,value=wolfcode的数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" name wolfcode\nOK\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 往Redis中存储key=age,value=18的数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" age "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看Redis中目前都有哪些Key")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" keys *\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看Redis中name的值是啥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get name\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wolfcode"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看Redis中age的值是啥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get age\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"18"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("如果想要修改原来的数据，那么就是覆盖这个key所对应的value即可")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 往Redis中存储key=name,value=java的数据,此时会覆盖原来的数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" name "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看Redis中name的值是啥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get name\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("对于不需要的数据，我们可以从Redis中把数据删除掉")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 在Redis中删除key=age的数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" del age\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看Redis都有哪些Key")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" keys *\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 获取Redis中不存在的key会返回nil")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get age\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nil"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("因为Redis是将数据存储到内存中的，随着时间的推移，业务的增多，那么服务器的内存占用也会越来越多. 对于某些数据刚发布的时候，访问比较多，比较频繁，所以我们可能会把这些数据存储到Redis中从而提供用户的访问速度，随着时间推移，这些数据用户可能不再访问了，但是依然占用着内存。Redis就提供了数据的过期时间的设置，给key设置过期时间之后，到了时间会自动删除掉该Key并释放内存。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 往Redis中存储key=sex,value=man的数据,数据有效时间为60秒")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" sex "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("man")]),s._v(" EX "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看Redis中sex的值是啥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get sex\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"man"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看sex的剩余有效时间")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" ttl sex\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 当sex的数据过期之后，通过ttl查看剩余有效时间")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" ttl sex\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查看name的剩余有效时间，如果没有设置过期时间，ttl返回的是-1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" ttl name\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"_3-2-命令总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-命令总结"}},[s._v("#")]),s._v(" 3.2 命令总结")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令")]),s._v(" "),t("th",[s._v("解释")]),s._v(" "),t("th",[s._v("示例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("keys  pattern")]),s._v(" "),t("td",[s._v("按照pattern 匹配规则，列表Redis中所有的key")]),s._v(" "),t("td",[s._v("keys *")])]),s._v(" "),t("tr",[t("td",[s._v("set key value")]),s._v(" "),t("td",[s._v("将key-value缓存redis中")]),s._v(" "),t("td",[s._v("set name wolfcode")])]),s._v(" "),t("tr",[t("td",[s._v("get key")]),s._v(" "),t("td",[s._v("从Redis中获取key对应value值")]),s._v(" "),t("td",[s._v("get name")])]),s._v(" "),t("tr",[t("td",[s._v("del key")]),s._v(" "),t("td",[s._v("删除一个key")]),s._v(" "),t("td",[s._v("del age")])]),s._v(" "),t("tr",[t("td",[s._v("set key value EX 有效秒数")]),s._v(" "),t("td",[s._v("设置key=value得同时设置数据有效时间")]),s._v(" "),t("td",[s._v("set sex man EX 60")])]),s._v(" "),t("tr",[t("td",[s._v("ttl key")]),s._v(" "),t("td",[s._v("查看某个key有效时间，如果没有设置有效时间返回-1，如果该key已经过期了，返回-2")]),s._v(" "),t("td",[s._v("ttl sex")])])])]),s._v(" "),t("h3",{attrs:{id:"_3-3-redis的key设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-redis的key设计"}},[s._v("#")]),s._v(" 3.3 Redis的Key设计")]),s._v(" "),t("p",[s._v("现在我们有这样一张商品表")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("product_id")]),s._v(" "),t("th",[s._v("product_name")]),s._v(" "),t("th",[s._v("product_image")]),s._v(" "),t("th",[s._v("price")]),s._v(" "),t("th",[s._v("quantity")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("1")]),s._v(" "),t("td",[s._v("Laptop")]),s._v(" "),t("td",[s._v("laptop_image.jpg")]),s._v(" "),t("td",[s._v("2999")]),s._v(" "),t("td",[s._v("50")])])])]),s._v(" "),t("p",[s._v("商品信息是很高频访问的，我们考虑提升系统性能，把商品数据存储到Redis中，用户查询的时候，我们就从Redis中获取即可. 那么我们应该如何往Redis中存储数据呢?")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" product_id "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" product_name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Laptop"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" product_image "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"laptop_image.jpg"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" price "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2999")]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" quantity "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\nOK\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("但是我们商品表中不止一条数据，如果是下面的情况，我们应该如何往Redis中存储数据呢?")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("product_id")]),s._v(" "),t("th",[s._v("product_name")]),s._v(" "),t("th",[s._v("product_image")]),s._v(" "),t("th",[s._v("price")]),s._v(" "),t("th",[s._v("quantity")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("1")]),s._v(" "),t("td",[s._v("Laptop")]),s._v(" "),t("td",[s._v("laptop_image.jpg")]),s._v(" "),t("td",[s._v("2999")]),s._v(" "),t("td",[s._v("50")])]),s._v(" "),t("tr",[t("td",[s._v("2")]),s._v(" "),t("td",[s._v("Coffee Maker")]),s._v(" "),t("td",[s._v("coffee_maker_image.jpg")]),s._v(" "),t("td",[s._v("599")]),s._v(" "),t("td",[s._v("200")])])])]),s._v(" "),t("p",[s._v("考虑到Redis如果key相同的情况会进行覆盖，所以我们对Key做了一些处理")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" product_name:1 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Laptop"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" product_image:1 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"laptop_image.jpg"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" price:1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2999")]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" quantity:1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" product_name:2 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Coffee Maker"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" product_image:2 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"coffee_maker_image.jpg"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" price:2 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("599")]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" quantity:2 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("\nOK\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("我们可以在原有的key上面添加主键(唯一标识)来区分不同数据内容,但是这样的话，当我们需要查询1号商品数据，我们需要这样操作.")]),s._v(" "),t("p",[s._v("1.根据主键=1，拼接字符串，从Redis中获取数据")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get product_name:1 \n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Laptop"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get product_image:1 \n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"laptop_image.jpg"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get price:1 \n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2999"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get quantity:1 \n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"50"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("取出数据之后封装成Product对象，然会给用户.")])]),s._v(" "),t("p",[s._v("这样操作，如果Product对象有很多的字段，那么我们获取数据的时候，需要访问Redis很多次，才能获取到完整的Product数据，所以我们一般是这样操作的.")]),s._v(" "),t("p",[s._v("1.将对象的JSON字符串存储到Redis中")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 将id=1的商品数据存储到Redis中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" SET product:1 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{'),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_id"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":1,"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_name"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("Laptop"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_image"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("laptop_image.jpg"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("price"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":2999,"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("quantity"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(':50}"')]),s._v("\nOK\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 将id=2的商品数据存储到Redis中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" SET product:2 "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{'),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_id"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":2,"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_name"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("Coffee Maker"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_image"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("coffee_maker_image.jpg"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("price"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":3999,"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("quantity"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(':200}"')]),s._v("\nOK\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("2.我们获取的时候,只需要从Redis中获取一次就可以了.")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" get product:1\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{'),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_id"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":1,"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_name"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("Laptop"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("product_image"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("laptop_image.jpg"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("price"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(":2999,"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("quantity"),t("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(':50}"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("3.获取到JSON字符串之后，在程序中转成对象即可.")]),s._v(" "),t("h3",{attrs:{id:"_3-4-key的设计规范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-key的设计规范"}},[s._v("#")]),s._v(" 3.4 Key的设计规范")]),s._v(" "),t("p",[s._v("我们在使用Redis的时候，需要定义很多的Key，那么定义这些Key的时候有哪些规范呢?")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("唯一性：")]),s._v(" Key 应该具有唯一性，以确保不同类型的数据不会发生冲突。确保 Key 的命名足够明确，以防止数据误用。")]),s._v(" "),t("li",[t("strong",[s._v("简洁性：")]),s._v(" 尽量保持 Key 的简洁，避免使用过长或过于复杂的 Key。短小的 Key 有助于减小内存占用和提高性能。")]),s._v(" "),t("li",[t("strong",[s._v("避免特殊字符：")]),s._v(" 避免在 Key 中使用特殊字符，如空格或控制字符。这有助于避免由于特殊字符而引起的问题。")]),s._v(" "),t("li",[t("strong",[s._v("命名空间：")]),s._v(' 可以通过在 Key 中使用命名空间来组织数据。例如，可以使用 "user:123" 表示用户数据，"product:456" 表示产品数据')]),s._v(" "),t("li",[t("strong",[s._v("可读性：")]),s._v(' Key 的命名应该具有可读性，以便开发人员和维护人员能够轻松理解和管理。采用有意义的命名规范，例如使用命名空间和层次结构，对于用户数据，可以选择使用 "user:123" 而不是 "u:123"')]),s._v(" "),t("li",[t("strong",[s._v("避免过期 Key：")]),s._v(" 如果数据有固定的生命周期，可以使用过期时间（TTL）来设置 Key 的过期时间，以防止无用数据长时间存储")])]),s._v(" "),t("p",[t("strong",[s._v("总结起来：唯一性，可读性，灵活性，失效性")])]),s._v(" "),t("h2",{attrs:{id:"四、redis数据结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、redis数据结构"}},[s._v("#")]),s._v(" 四、Redis数据结构")]),s._v(" "),t("p",[s._v("Redis支持的存储数据类型有很多：")]),s._v(" "),t("p",[t("strong",[s._v("常用")]),s._v("：")]),s._v(" "),t("p",[s._v("string（字符串，hash（哈希），list（列表），set（集合），zset (sorted set：有序集合)")]),s._v(" "),t("p",[t("strong",[s._v("不常用")]),s._v("：")]),s._v(" "),t("p",[s._v("HyperLogLog，Bitmap(位图)，Bloom Filter(布隆过滤器)，Geospatial(地理位置) ，Module(模块)， Streams(流信息)")]),s._v(" "),t("p",[s._v("我们主要讲解常用的五种数据类型.")]),s._v(" "),t("h3",{attrs:{id:"_4-1-string类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-string类型"}},[s._v("#")]),s._v(" 4.1 String类型")]),s._v(" "),t("p",[s._v("String类型是Redis用的较多的一个基本类型，也是最简单的一种类型，它和我们在Java中使用的字符类型什么太大区别")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/1666682-20211020192622689-1303968847.png",alt:""}})])]),s._v(" "),t("h4",{attrs:{id:"_4-1-1-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-常用命令"}},[s._v("#")]),s._v(" 4.1.1 常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("set key value")]),s._v(" "),t("td",[s._v("将key-value缓存redis中")]),s._v(" "),t("td",[s._v("set name wolfcode")])]),s._v(" "),t("tr",[t("td",[s._v("get key")]),s._v(" "),t("td",[s._v("从redis中获取key对应value值")]),s._v(" "),t("td",[s._v("get name")])]),s._v(" "),t("tr",[t("td",[s._v("del  key")]),s._v(" "),t("td",[s._v("从redis中删除key")]),s._v(" "),t("td",[s._v("del name")])]),s._v(" "),t("tr",[t("td",[s._v("ttl key")]),s._v(" "),t("td",[s._v("查看key存活时间")]),s._v(" "),t("td",[s._v("ttl sex")])]),s._v(" "),t("tr",[t("td",[s._v("mset key1 value1 key2 value2 ...")]),s._v(" "),t("td",[s._v("批量设置值")]),s._v(" "),t("td",[s._v("mset name wolfcode age 18")])]),s._v(" "),t("tr",[t("td",[s._v("mget key1 key2 ...")]),s._v(" "),t("td",[s._v("批量获取值")]),s._v(" "),t("td",[s._v("mget name age")])]),s._v(" "),t("tr",[t("td",[s._v("incr key")]),s._v(" "),t("td",[s._v("对指定的key对应的value进行原子性递增(value必须是int类型)")]),s._v(" "),t("td",[s._v("incr age")])]),s._v(" "),t("tr",[t("td",[s._v("decr key")]),s._v(" "),t("td",[s._v("对指定的key对应的value进行原子性递减")]),s._v(" "),t("td",[s._v("decr age")])]),s._v(" "),t("tr",[t("td",[s._v("setex key seconds value")]),s._v(" "),t("td",[s._v("将key-value缓存到redis中，seconds 秒后失效")]),s._v(" "),t("td",[s._v("setex  sex  10  man")])]),s._v(" "),t("tr",[t("td",[s._v("setnx key value")]),s._v(" "),t("td",[s._v("如果key已经存，不做任何操作返回0，如果key不存，直接添加返回1")]),s._v(" "),t("td",[s._v("setnx  name java")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-1-2-非常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-非常用命令"}},[s._v("#")]),s._v(" 4.1.2 非常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("incrby key increment")]),s._v(" "),t("td",[s._v("给key对应值加increment")]),s._v(" "),t("td",[s._v("incrby age 10")])]),s._v(" "),t("tr",[t("td",[s._v("append key  value")]),s._v(" "),t("td",[s._v("在key对应的value值中拼+value")]),s._v(" "),t("td",[s._v("append name yes")])]),s._v(" "),t("tr",[t("td",[s._v("setrange key  offset  value")]),s._v(" "),t("td",[s._v("修改key对应的value值,替换为指定value,冲offset索引位置开始")]),s._v(" "),t("td",[s._v("setrange name 2   xx")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-1-3-应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-3-应用场景"}},[s._v("#")]),s._v(" 4.1.3 应用场景")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("分布式缓存")])]),s._v(" "),t("p",[s._v("首先最基本的就是用来做业务数据的缓存，如图所示，Redis中会缓存一些常用的热点数据，可以提升数据查询的性能。")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/1666682-20211020192624192-635130158.png",alt:""}})])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("分布式全局ID")]),s._v(":")]),s._v(" "),t("p",[s._v("使用String类型的incr命令，实现原子递增")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("限流")]),s._v(":")]),s._v(" "),t("p",[s._v("使用计数器实现手机验证码频率限流")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("分布式session")]),s._v(":")]),s._v(" "),t("p",[s._v("基于登录场景中，保存token信息。")])])]),s._v(" "),t("h3",{attrs:{id:"_4-2-list类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-list类型"}},[s._v("#")]),s._v(" 4.2 List类型")]),s._v(" "),t("p",[s._v("列表类型(list)可以存储一个有序且可重复的字符串列表，常用的操作是向列表两端添加元素或者获得列表的某一个片段")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/1666682-20211020192624370-2094512803.png",alt:""}})])]),s._v(" "),t("h4",{attrs:{id:"_4-2-1-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-常用命令"}},[s._v("#")]),s._v(" 4.2.1 常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("lpush key value")]),s._v(" "),t("td",[s._v("从队列的左边入队列一个或者多个元素")]),s._v(" "),t("td",[s._v("lpush hobby java")])]),s._v(" "),t("tr",[t("td",[s._v("rpush  key  value")]),s._v(" "),t("td",[s._v("从队列的右边入队列一个或者多个元素")]),s._v(" "),t("td",[s._v("rpush hobby python")])]),s._v(" "),t("tr",[t("td",[s._v("llen key")]),s._v(" "),t("td",[s._v("获取列表长度")]),s._v(" "),t("td",[s._v("llen hobby")])]),s._v(" "),t("tr",[t("td",[s._v("lrange key start stop")]),s._v(" "),t("td",[s._v("返回从左边开始列表key集合，从start位置开始，stop位置结束")]),s._v(" "),t("td",[s._v("lrange hobby 0 -1")])]),s._v(" "),t("tr",[t("td",[s._v("lpop key")]),s._v(" "),t("td",[s._v("从队列的左边出队列一个元素")]),s._v(" "),t("td",[s._v("lpop hobby")])]),s._v(" "),t("tr",[t("td",[s._v("rpop key")]),s._v(" "),t("td",[s._v("弹出key集合中最右边的数据")]),s._v(" "),t("td",[s._v("rpop hobby")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-2-2-非常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-非常用命令"}},[s._v("#")]),s._v(" 4.2.2 非常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("linsert key before pivot value")]),s._v(" "),t("td",[s._v("操作key集合，在pivot值之前插入value")]),s._v(" "),t("td",[s._v("linsert hobby before java  c##")])]),s._v(" "),t("tr",[t("td",[s._v("linsert key  after  pivot value")]),s._v(" "),t("td",[s._v("操作key集合，在pivot值之后插入value")]),s._v(" "),t("td",[s._v("linsert hobby after  java  c##")])]),s._v(" "),t("tr",[t("td",[s._v("lset key  index  value")]),s._v(" "),t("td",[s._v("操作key集合，更新索引index位置值为value")]),s._v(" "),t("td",[s._v("lset hobby 1  go")])]),s._v(" "),t("tr",[t("td",[s._v("lrem key count  value")]),s._v(" "),t("td",[s._v("操作key集合，删除 count个 value值")]),s._v(" "),t("td",[s._v("lrem hobby 3   go")])]),s._v(" "),t("tr",[t("td",[s._v("ltrim   key  start stop")]),s._v(" "),t("td",[s._v("操作key集合，从start到stop截取自列表")]),s._v(" "),t("td",[s._v("ltrim  hobby 2   4")])]),s._v(" "),t("tr",[t("td",[s._v("lindex  key  index")]),s._v(" "),t("td",[s._v("操作key集合，获取索引为index位置的数据")]),s._v(" "),t("td",[s._v("lindex  hobby 1")])]),s._v(" "),t("tr",[t("td",[s._v("blpop key timeout")]),s._v(" "),t("td",[s._v("删除，并获取该列表左边第一个元素，如果当前队列没有元素则阻塞，知道有新的元素入队")]),s._v(" "),t("td",[s._v("blpop hobby timeout")])]),s._v(" "),t("tr",[t("td",[s._v("brpop key timeout")]),s._v(" "),t("td",[s._v("删除，并获取该列表右边第一个元素，如果当前队列没有元素则阻塞，知道有新的元素入队")]),s._v(" "),t("td",[s._v("brpop hobby timeout")])]),s._v(" "),t("tr",[t("td",[s._v("rpoplpush source destination")]),s._v(" "),t("td",[s._v("命令rpoplpush在一个原子时间内，执行以下两个动作:  1.将列表source中的最后一个元素(尾元素)弹出，并返回给客户端。2.将source弹出的元素插入到列表destination，作为destination列表的头元素")]),s._v(" "),t("td",[s._v("rpoplpush hobby new_hobby")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-2-2-应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-应用场景"}},[s._v("#")]),s._v(" 4.2.2 应用场景")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("发红包的场景")])]),s._v(" "),t("p",[s._v("在发红包的场景中，假设发一个10元，10个红包，需要保证抢红包的人不会多抢到，也不会少抢到，这种情况下，可以根据下图所示去实现。")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/1666682-20211020192627094-337269500.png",alt:""}})])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("朋友圈的点赞列表")])]),s._v(" "),t("p",[s._v("有好友点赞之后，把好友的头像信息使用List存储起来")])])]),s._v(" "),t("h3",{attrs:{id:"_4-3-hash类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-hash类型"}},[s._v("#")]),s._v(" 4.3 Hash类型")]),s._v(" "),t("p",[s._v("Hash类型大家应该都不陌生，他就是一个键值对集合，如下图所示。Hash相当于一个 string 类型的 key和 value 的映射表，key 还是key，但是value是一个键值对（key-value），类比于 Java里面的 Map<String,Map<String,Object>> 集合。")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/1666682-20211020192627349-218916856.png",alt:""}})])]),s._v(" "),t("h4",{attrs:{id:"_4-3-1-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-常用命令"}},[s._v("#")]),s._v(" 4.3.1 常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("hset key field  value")]),s._v(" "),t("td",[s._v("将field  value对缓存到redis中hash中，键值为key")]),s._v(" "),t("td",[s._v("hset user name wolfcode")])]),s._v(" "),t("tr",[t("td",[s._v("hget key field")]),s._v(" "),t("td",[s._v("从key对应hash列表中获取field字段")]),s._v(" "),t("td",[s._v("hget user  name")])]),s._v(" "),t("tr",[t("td",[s._v("hexists key  field")]),s._v(" "),t("td",[s._v("判断key对应的hash列表是否存在 field字段")]),s._v(" "),t("td",[s._v("hexists user age")])]),s._v(" "),t("tr",[t("td",[s._v("hdel key  field")]),s._v(" "),t("td",[s._v("删除key对应hash列表中field字段")]),s._v(" "),t("td",[s._v("hdel user age")])]),s._v(" "),t("tr",[t("td",[s._v("hincrby  key  field  increment")]),s._v(" "),t("td",[s._v("给key对应hash列表中field字段 + increment")]),s._v(" "),t("td",[s._v("hincrby user  age 10")])]),s._v(" "),t("tr",[t("td",[s._v("hlen key")]),s._v(" "),t("td",[s._v("查看key对应的hash列表field的数量")]),s._v(" "),t("td",[s._v("hlen user")])]),s._v(" "),t("tr",[t("td",[s._v("hkeys  key")]),s._v(" "),t("td",[s._v("获取key对应的hash列表所有的field值")]),s._v(" "),t("td",[s._v("hkeys  user")])]),s._v(" "),t("tr",[t("td",[s._v("hvals  key")]),s._v(" "),t("td",[s._v("获取key对应的hash列表所有的field对应的value值")]),s._v(" "),t("td",[s._v("hvals  user")])]),s._v(" "),t("tr",[t("td",[s._v("hgetall key")]),s._v(" "),t("td",[s._v("获取key对应的hash列表中所有的field及其对应的value值")]),s._v(" "),t("td",[s._v("hgetall user")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-3-2-应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-应用场景"}},[s._v("#")]),s._v(" 4.3.2 应用场景")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("购物车功能")])]),s._v(" "),t("p",[s._v("以用户ID作为key，以商品id作为field，以商品的数量作为value")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111151422478.png",alt:""}})])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("配置信息")])]),s._v(" "),t("p",[s._v("我们有需求要获取所有的配置信息，也有需求只想获取某个名称的配置信息，这种情况使用Hash比较合适.")])])]),s._v(" "),t("h3",{attrs:{id:"_4-4-set类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-set类型"}},[s._v("#")]),s._v(" 4.4 Set类型")]),s._v(" "),t("p",[s._v("如下图所示，集合类型 (Set) 是一个无序并唯一的键值集合。它的存储顺序不会按照插入的先后顺序进行存储。")]),s._v(" "),t("p",[s._v("集合类型和列表类型的区别如下：")]),s._v(" "),t("ul",[t("li",[s._v("列表可以存储重复元素，集合只能存储非重复元素；")]),s._v(" "),t("li",[s._v("列表是按照元素的先后顺序存储元素的，而集合则是无序方式存储元素的。")])]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/1666682-20211020192629214-788081891.png",alt:""}})])]),s._v(" "),t("h4",{attrs:{id:"_4-4-1-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-1-常用命令"}},[s._v("#")]),s._v(" 4.4.1 常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("sadd key  members [....]")]),s._v(" "),t("td",[s._v("往key 集合中添加member元素")]),s._v(" "),t("td",[s._v("sadd myset a  b  c b")])]),s._v(" "),t("tr",[t("td",[s._v("scard key")]),s._v(" "),t("td",[s._v("获取集合里面的元素数量")]),s._v(" "),t("td",[s._v("scard myset")])]),s._v(" "),t("tr",[t("td",[s._v("smembers key")]),s._v(" "),t("td",[s._v("遍历key集合中所有的元素")]),s._v(" "),t("td",[s._v("smembers myset")])]),s._v(" "),t("tr",[t("td",[s._v("sismember key member")]),s._v(" "),t("td",[s._v("判断 member元素是否集合 key 的成员。")]),s._v(" "),t("td",[s._v("sismember myset c")])]),s._v(" "),t("tr",[t("td",[s._v("srem  key members [....]")]),s._v(" "),t("td",[s._v("删除key集合中members元素")]),s._v(" "),t("td",[s._v("srem myset a")])]),s._v(" "),t("tr",[t("td",[s._v("spop key count")]),s._v(" "),t("td",[s._v("从key集合中随机弹出count个元素")]),s._v(" "),t("td",[s._v("spop myset 1")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-4-2-非常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-2-非常用命令"}},[s._v("#")]),s._v(" 4.4.2 非常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[t("strong",[s._v("sdiff key1   key2")])]),s._v(" "),t("td",[t("strong",[s._v("返回key1中特有的元素的差集")])]),s._v(" "),t("td",[t("strong",[s._v("sdiff key1 key2")])])]),s._v(" "),t("tr",[t("td",[s._v("sdiffstore  dest  key1 key2")]),s._v(" "),t("td",[s._v("返回key1中特有的元素，并将返回值缓存到dest集合中")]),s._v(" "),t("td",[s._v("sidiffstore  dest  key1 key2")])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("sinter key1 key2")])]),s._v(" "),t("td",[t("strong",[s._v("返回key1跟key2集合的交集")])]),s._v(" "),t("td",[t("strong",[s._v("sinter key1 key2")])])]),s._v(" "),t("tr",[t("td",[s._v("sinterstore  dest key1 key2")]),s._v(" "),t("td",[s._v("返回key1跟key2集合的交集，并将返回值缓存到dest集合中")]),s._v(" "),t("td",[s._v("sinterstore  dest key1 key2")])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("sunion key1  key2")])]),s._v(" "),t("td",[t("strong",[s._v("返回key1跟key2集合的并集")])]),s._v(" "),t("td",[t("strong",[s._v("sunion key1  key2")])])]),s._v(" "),t("tr",[t("td",[s._v("sunionstore dest key1  key2")]),s._v(" "),t("td",[s._v("返回key1跟key2集合的并集，并将返回值缓存到dest集合中")]),s._v(" "),t("td",[s._v("sunionstore dest key1  key2")])]),s._v(" "),t("tr",[t("td",[s._v("smove source destination member")]),s._v(" "),t("td",[s._v("将source集合中member元素移动到destination集合中")]),s._v(" "),t("td",[s._v("smove key1  key2 aa")])]),s._v(" "),t("tr",[t("td",[s._v("srandmember  key  count")]),s._v(" "),t("td",[s._v("随机获取set集合中count 个元素")]),s._v(" "),t("td",[s._v("srandmember key1 1")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-4-3-应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-3-应用场景"}},[s._v("#")]),s._v(" 4.4.3 应用场景")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("去重")])]),s._v(" "),t("li",[t("p",[s._v("抽奖")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1：准备一个抽奖池:\nsadd luckydraw Richard Tony Lily Sophia Zoe Thomas Anne Lucy Jack Tom\n2：抽3个三等奖:spop luckydraw 3\n3：抽2个二等奖:spop luckydraw 2\n4：抽1个:一等奖:spop luckydraw 1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("好友推荐功能")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("给用户添加标签。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("sadd user:1:basketball game coding swing\nsadd user:2:sing coding "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" basketball\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nsadd user:k:tags tag1 tag2 tag4\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("使用sinter命令，可以来计算用户共同感兴趣的标签")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("sinter user:1 user:2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])]),s._v(" "),t("p",[s._v("这种标签系统在电商系统、社交系统、视频网站，图书网站，旅游网站等都有着广泛的应用。例如一个用户可能对娱乐、体育比较感兴趣，另一个用户可能对历史、新闻比较感兴趣，")]),s._v(" "),t("p",[s._v("这些兴趣点就是标签。有了这些数据就可以得到喜欢同一个标签的人，以及用户的共同喜好的标签，这些数据对于用户体验以及增强用户黏度比较重要。")]),s._v(" "),t("p",[s._v("例如一个社交系统可以根据用户的标签进行好友的推荐，已经用户感兴趣的新闻的推荐等，一个电子商务的网站会对不同标签的用户做不同类型的推荐，比如对数码产品比较感兴趣的人，")]),s._v(" "),t("p",[s._v("在各个页面或者通过邮件的形式给他们推荐最新的数码产品，通常会为网站带来更多的利益")])])]),s._v(" "),t("h3",{attrs:{id:"_4-5-zset类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-zset类型"}},[s._v("#")]),s._v(" 4.5 zSet类型")]),s._v(" "),t("p",[s._v("有序集合类型，顾名思义，和前面讲的集合类型的区别就是多了有序的功能。")]),s._v(" "),t("p",[s._v("如下图所示，在集合类型的基础上，有序集合类型为集合中的每个元素都关联了一个分数（浮点型），这使得我们不仅可以完成插入、删除和判断元素是否存在等集合类型支持的操作，还能获得分数最高(或最低)的前N个元素、获得指定分数范围内的元素等与分数有关的操作。")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/1666682-20211020192630282-68030134.png",alt:""}})])]),s._v(" "),t("h4",{attrs:{id:"_4-5-1-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-1-常用命令"}},[s._v("#")]),s._v(" 4.5.1 常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("zadd key score member")]),s._v(" "),t("td",[s._v("往key集合中添加member元素，分数为score")]),s._v(" "),t("td",[s._v("zadd players 100  a")])]),s._v(" "),t("tr",[t("td",[s._v("zincrby  key increment  member")]),s._v(" "),t("td",[s._v("将key集合中的member元素 分数 + increment")]),s._v(" "),t("td",[s._v("zadd players 100  a")])]),s._v(" "),t("tr",[t("td",[s._v("zrange  key  start  stop [withscores]")]),s._v(" "),t("td",[s._v("将key集合中的元素按分数升序排列 [显式分数]")]),s._v(" "),t("td",[s._v("zrange players 0 -1  withscores")])]),s._v(" "),t("tr",[t("td",[s._v("zrevrange key  start  stop [withscores]")]),s._v(" "),t("td",[s._v("将key集合中的元素按分数降序排列 [显式分数]")]),s._v(" "),t("td",[s._v("zrevrange players 0 -1  withscores")])]),s._v(" "),t("tr",[t("td",[s._v("zrank  key  member")]),s._v(" "),t("td",[s._v("返回member元素在key结合中的正序排名")]),s._v(" "),t("td",[s._v("zrank players  a")])]),s._v(" "),t("tr",[t("td",[s._v("zrevrank key  member")]),s._v(" "),t("td",[s._v("返回member元素在key结合中的倒序排名")]),s._v(" "),t("td",[s._v("zrevrank players  a")])]),s._v(" "),t("tr",[t("td",[s._v("zcard  key")]),s._v(" "),t("td",[s._v("返回key集合元素个数")]),s._v(" "),t("td",[s._v("zcard  players")])])])]),s._v(" "),t("h4",{attrs:{id:"_4-5-2-非常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-2-非常用命令"}},[s._v("#")]),s._v(" 4.5.2 非常用命令")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("zrangebyscore  key  min  max  [withscores]")]),s._v(" "),t("td",[s._v("按[min, max) 分数范围返回key集合中元素(正序)")]),s._v(" "),t("td",[s._v("zrangebyscore players  200 300  withscores")])]),s._v(" "),t("tr",[t("td",[s._v("zrevrangebyscore key  min  max  [withscores]")]),s._v(" "),t("td",[s._v("按[min, max) 分数范围返回key集合中元素(倒序)")]),s._v(" "),t("td",[s._v("zrevrangebyscore players  200 300  withscores")])]),s._v(" "),t("tr",[t("td",[s._v("zrem key member")]),s._v(" "),t("td",[s._v("删除key集合中member元素与分数")]),s._v(" "),t("td",[s._v("zrem players  a")])]),s._v(" "),t("tr",[t("td",[s._v("zremrangebyscore  key min max  withscores")]),s._v(" "),t("td",[s._v("按[min, max) 分数范围删除key集合中元素")]),s._v(" "),t("td",[s._v("zremrangebyscore  players  200 300  withscores")])]),s._v(" "),t("tr",[t("td",[s._v("zremrangebyrank  key start  stop")]),s._v(" "),t("td",[s._v("删除key集合正序排名落在[start, stop) 范围元素")]),s._v(" "),t("td",[s._v("zremrangebyrank  players  10  20")])]),s._v(" "),t("tr",[t("td",[s._v("zcount key min max")]),s._v(" "),t("td",[s._v("按照分数范围[min, max]统计key集合中元素个数")]),s._v(" "),t("td",[s._v("zcount  players  100 300")])]),s._v(" "),t("tr",[t("td",[s._v("ZUNIONSTORE")]),s._v(" "),t("td",[s._v("计算给定的一个或多个有序集的并集")]),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("ZINTERSTORE")]),s._v(" "),t("td",[s._v("计算给定的一个或多个有序集的交集")]),s._v(" "),t("td")])])]),s._v(" "),t("h4",{attrs:{id:"_4-5-3-应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-3-应用场景"}},[s._v("#")]),s._v(" 4.5.3 应用场景")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("排行榜系统")])]),s._v(" "),t("p",[s._v("有序集合比较典型的使用场景就是排行榜系统。例如学生成绩的排名。某视频(博客等)网站的用户点赞、播放排名、电商系统中商品的销量排名等。我们以博客点赞为例。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("添加用户赞数")]),s._v(" "),t("p",[s._v("例如小编Tom发表了一篇博文，并且获得了10个赞。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("zadd user:ranking article1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("取消用户赞数")]),s._v(" "),t("p",[s._v("这个时候有一个读者又觉得Tom写的不好，又取消了赞，此时需要将文章的赞数从榜单中减去1，可以使用zincrby。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("zincrby user:ranking "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v(" article1 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("查看某篇文章的赞数")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("ZSCORE user:ranking arcticle1 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("展示获取赞数最多的十篇文章")]),s._v(" "),t("p",[s._v("此功能使用zrevrange命令实现：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("zrevrange user:ranking "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#0 到 10表示元素个数索引")]),s._v("\nzrevrangebyscore user:ranking "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##  按照分数从高到低排名，99，0表示score")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])])])]),s._v(" "),t("h2",{attrs:{id:"五、全局命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、全局命令"}},[s._v("#")]),s._v(" 五、全局命令")]),s._v(" "),t("p",[s._v("全局命令针对的是所有的key.")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("命令格式")]),s._v(" "),t("th",[s._v("功能")]),s._v(" "),t("th",[s._v("案例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("keys  pattern")]),s._v(" "),t("td",[s._v("按照pattern 匹配规则，列表redis中所有的key")]),s._v(" "),t("td",[s._v("keys xxx:*")])]),s._v(" "),t("tr",[t("td",[s._v("exists  key")]),s._v(" "),t("td",[s._v("判断key是否存在")]),s._v(" "),t("td",[s._v("exists name")])]),s._v(" "),t("tr",[t("td",[s._v("expire key  seconds")]),s._v(" "),t("td",[s._v("给key设置过期时间，超时：seconds")]),s._v(" "),t("td",[s._v("expire name 10")])]),s._v(" "),t("tr",[t("td",[s._v("persist key")]),s._v(" "),t("td",[s._v("取消key过期时间")]),s._v(" "),t("td",[s._v("persist  name")])]),s._v(" "),t("tr",[t("td",[s._v("select  index")]),s._v(" "),t("td",[s._v("切换数据库，默认是第0个，共有【0,15】个")]),s._v(" "),t("td",[s._v("select 0")])]),s._v(" "),t("tr",[t("td",[s._v("move key   db")]),s._v(" "),t("td",[s._v("从当前数据库将key移动到指定db库")]),s._v(" "),t("td",[s._v("move name 1")])]),s._v(" "),t("tr",[t("td",[s._v("randomkey")]),s._v(" "),t("td",[s._v("随机返回一个key")]),s._v(" "),t("td",[s._v("randomkey")])]),s._v(" "),t("tr",[t("td",[s._v("rename key newkey")]),s._v(" "),t("td",[s._v("将key改名为newkey")]),s._v(" "),t("td",[s._v("rename name  newname")])]),s._v(" "),t("tr",[t("td",[s._v("echo message")]),s._v(" "),t("td",[s._v("打印message信息")]),s._v(" "),t("td",[s._v("echo  message")])]),s._v(" "),t("tr",[t("td",[s._v("dbsize")]),s._v(" "),t("td",[s._v("查看key个数")]),s._v(" "),t("td",[s._v("dbsize")])]),s._v(" "),t("tr",[t("td",[s._v("info")]),s._v(" "),t("td",[s._v("查看redis数据库信息")]),s._v(" "),t("td",[s._v("info")])]),s._v(" "),t("tr",[t("td",[s._v("config get  *")]),s._v(" "),t("td",[s._v("查看所有redis配置信息")]),s._v(" "),t("td",[s._v("config get *")])]),s._v(" "),t("tr",[t("td",[s._v("flushdb")]),s._v(" "),t("td",[s._v("清空当前数据库")]),s._v(" "),t("td",[s._v("flushdb")])]),s._v(" "),t("tr",[t("td",[s._v("flushall")]),s._v(" "),t("td",[s._v("清空所有数据库")]),s._v(" "),t("td",[s._v("flushall")])])])]),s._v(" "),t("h2",{attrs:{id:"六、redis的安全性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六、redis的安全性"}},[s._v("#")]),s._v(" 六、Redis的安全性")]),s._v(" "),t("p",[s._v("我们可以通过设置密码以及绑定IP的方式来增加Redis的安全性，这样可以限制未授权的访问和潜在的攻击源")]),s._v(" "),t("p",[s._v("我们可以在window中找到"),t("code",[s._v("redis.windows-service.conf")]),s._v("文件,修改配置信息")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("requirepass wolfcode\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("在服务中重启Redis")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111155707967.png",alt:""}})])]),s._v(" "),t("p",[s._v("如果我们访问的时候，没有携带密码登录，会提示如下信息")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111160019740.png",alt:""}})])]),s._v(" "),t("p",[s._v("我们在连接到Redis的时候给他设置密码")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111160106964.png",alt:""}})])]),s._v(" "),t("h2",{attrs:{id:"七、java客户端操作redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七、java客户端操作redis"}},[s._v("#")]),s._v(" 七、Java客户端操作Redis")]),s._v(" "),t("p",[s._v("当前Redis支持的编程语言有：https://Redis.io/docs/clients/")]),s._v(" "),t("p",[s._v("目前市面上有很多的Redis的Java客户端框架，我们选取两款比较常用的给大家演示如何使用Java客户端操作Redis")]),s._v(" "),t("h3",{attrs:{id:"_7-1-jedis客户端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-jedis客户端"}},[s._v("#")]),s._v(" 7.1 Jedis客户端")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("创建项目，添加依赖")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("parent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-parent"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("2.3.3.RELEASE"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("relativePath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("/>")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- lookup parent from repository --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("parent")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependencies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-test"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("scope")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("test"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("scope")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("redis.clients"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("jedis"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("3.3.0"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.projectlombok"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("lombok"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependencies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("添加配置信息")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Redis配置--jedis版")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jedis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Redis服务器的IP")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Redis服务器的Port")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据库密码")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#连接超时时间")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7200")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#最大活动对象数")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxTotall")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#最大能够保持idel状态的对象数")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#最小能够保持idel状态的对象数")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("minIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当池内没有返回对象时，最大等待时间")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxWaitMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当调用borrow Object方法时，是否进行有效性检查")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("testOnBorrow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#当调用return Object方法时，是否进行有效性检查")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("testOnReturn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#“空闲链接”检测线程，检测的周期，毫秒数。如果为负值，表示不运行“检测线程”。默认为-1.")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeBetweenEvictionRunsMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#向调用者输出“链接”对象时，是否检测它的空闲超时；")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("testWhileIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 对于“空闲链接”检测线程而言，每次检测的链接资源的个数。默认为3.")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("numTestsPerEvictionRun")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("编写Jedis配置类")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Configuration")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisConfig")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * jedis连接池\n     * @param jedisProperties\n     * @return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Bean")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisPool")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("jedisPool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisProperties")]),s._v(" jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisPoolConfig")]),s._v(" config "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisPoolConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMaxTotal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMaxTotall")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMaxIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMaxIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMinIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMinIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMaxWaitMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getMaxWaitMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTestOnBorrow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isTestOnBorrow")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTestOnReturn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isTestOnReturn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeBetweenEvictionRunsMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getTimeBetweenEvictionRunsMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTestWhileIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isTestWhileIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setNumTestsPerEvictionRun")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getNumTestsPerEvictionRun")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hasText")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getPassword")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisPool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                    jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getPassword")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisPool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHost")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                jedisProperties"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getTimeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("编写测试类，实现测试")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testConnection")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedisPool"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jedis")]),s._v(" jedis "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" jedisPool"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//需求：往Redis中添加kv对： name：dafei")]),s._v("\n    jedis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wolfcode"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    jedis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"_7-2-lettuce"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-lettuce"}},[s._v("#")]),s._v(" 7.2 Lettuce")]),s._v(" "),t("p",[s._v("Lettuce 之所以能流行，因为它抱了根好大腿spring-data。spring-data-redis底层就封装了Lettuce，接下来看下SpringBoot版的lettuce实现。")]),s._v(" "),t("ol",[t("li",[s._v("添加依赖")])]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-data-redis"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("添加配置")])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("host")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 127.0.0.1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wolfcode\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("编写测试类")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SpringBootTest")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LettureTest")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringRedisTemplate")]),s._v(" template"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Test")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testRedis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        template"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("template"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nickname"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 操作string")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//template.opsForValue().xx();")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 操作hash")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//template.opsForHash().xx();")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 操作list")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//template.opsForList().xx();")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 操作set")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//template.opsForSet().xx();")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 操作zset")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//template.opsForZSet().xx();")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//全局命令在template类上")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//template.keys("*");')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("h2",{attrs:{id:"八、redis事务-拓展"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#八、redis事务-拓展"}},[s._v("#")]),s._v(" 八、Redis事务[拓展]")]),s._v(" "),t("p",[s._v("一个事务从开始到执行会经历以下三个阶段：")]),s._v(" "),t("ul",[t("li",[s._v("开始事务。")]),s._v(" "),t("li",[s._v("命令入队。")]),s._v(" "),t("li",[s._v("执行事务。")])]),s._v(" "),t("p",[s._v("它先以 "),t("strong",[s._v("MULTI")]),s._v(" 开始一个事务， 然后将多个命令入队到事务中， 最后由 "),t("strong",[s._v("EXEC")]),s._v(" 命令触发事务， 一并执行事务中的所有命令：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("Redis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" MULTI\nOK\n\nRedis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" SET book-name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mastering C++ in 21 days"')]),s._v("\nQUEUED\n\nRedis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" GET book-name\nQUEUED\n\nRedis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" SADD tag "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C++"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Programming"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mastering Series"')]),s._v("\nQUEUED\n\nRedis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" SMEMBERS tag\nQUEUED\n\nRedis "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" EXEC\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" OK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mastering C++ in 21 days"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mastering Series"')]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C++"')]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Programming"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("单个 Redis 命令的执行是原子性的，但 Redis 没有在事务上增加任何维持原子性的机制，所以 Redis 事务的执行并不是原子性的。")]),s._v(" "),t("p",[s._v("Redis事务可以理解为一个"),t("strong",[s._v("打包的批量执行脚本")]),s._v("，但批量指令并非原子化的操作，中间某条指令的失败不会导致前面已做指令的回滚，也不会造成后续的指令不做。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" multi\nOK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" name dafei\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" age "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" incr age \nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" incr name\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" get age\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" get name\nQUEUED\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" OK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" OK\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("error"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ERR value is not an integer or out of range\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"19"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dafei"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("Redis 事务可以一次执行多个命令， 并且带有以下三个重要的保证：")]),s._v(" "),t("ul",[t("li",[s._v("批量操作在发送 EXEC 命令前被放入队列缓存。")]),s._v(" "),t("li",[s._v("收到 EXEC 命令后进入事务执行，事务中任意命令执行失败，其余的命令依然被执行。")]),s._v(" "),t("li",[s._v("在事务执行过程，其他客户端提交的命令请求不会插入到事务执行命令序列中。")])]),s._v(" "),t("h2",{attrs:{id:"九、redis持久化机制-拓展"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#九、redis持久化机制-拓展"}},[s._v("#")]),s._v(" 九、Redis持久化机制[拓展]")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111164446323.png",alt:""}})])]),s._v(" "),t("p",[s._v("虽然Redis的数据存储到内存中，但是也会不定期的往磁盘中进行同步，保证了Redis在重启之后，不至于所有数据都丢失.")]),s._v(" "),t("p",[s._v("Redis持久化机制目前以后3种，分别为：")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("快照方式")]),s._v("（RDB, Redis DataBase）")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("文件追加方式")]),s._v("（AOF, Append Only File）")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("混合持久化方式")]),s._v("（Redis4版本之后）")])])]),s._v(" "),t("h3",{attrs:{id:"_9-1-rdb方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-rdb方式"}},[s._v("#")]),s._v(" 9.1 RDB方式")]),s._v(" "),t("p",[s._v("Snapshotting(快照)默认方式，将内存数据中以快照的方式写入到二进制文件中，默认为dump.rdb。触发RDB持久化过程分手动触发与自动触发。")]),s._v(" "),t("p",[t("strong",[s._v("触发机制")])]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("手动触发")])]),s._v(" "),t("p",[s._v("使用save命令：会阻塞当前Redis服务器，知道RDB过程完成为主，如果内存数据较多，会造成长时间阻塞，影响其他命令的使用，不建议轻易使用")]),s._v(" "),t("p",[s._v("使用bgsave命令：Redis进程执行fork指令创建子进程，由子进程实现RDB持久化，有需要时建议使用bgsave命令。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("自动触发")])]),s._v(" "),t("p",[s._v("使用save相关配置，格式： save m n      表示m秒内数据集存在n次修改时会自动触发bgsave命令。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("save 900 1  #900秒内如果超过1个Key被修改则发起快照保存\nsave 300 10 #300秒内如果超过10个key被修改,则发起快照保存\nsave 60 10000\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111165401272.png",alt:""}})])])])]),s._v(" "),t("p",[t("strong",[s._v("优点:")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("RDB快照文件是一个紧凑压缩的二进制文件，非常使用用于备份，全量复制等场景。开发中可以按照每6小时执行一次bgsave备份，用于容灾备份。")])]),s._v(" "),t("li",[t("p",[s._v("Redis加载RDB恢复数据远远快于AOF方式")])])]),s._v(" "),t("p",[t("strong",[s._v("缺点:")])]),s._v(" "),t("ul",[t("li",[s._v("RDB无法做到实时持久化/秒级持久化，每次bgsave时都需要fork子进程，频繁执行有时间成本。")]),s._v(" "),t("li",[s._v("RDB快照文件不同版本格式不一样，容易引起兼容问题。")])]),s._v(" "),t("h3",{attrs:{id:"_9-2-aof方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-aof方式"}},[s._v("#")]),s._v(" 9.2 AOF方式")]),s._v(" "),t("p",[s._v("AOF与RDB不一样，它是一独立日志的方式记录每次写命令，重启时再重新执行AOF文件中命令达到恢复数据的目的。解决了数据持久化的实时性的问题。")]),s._v(" "),t("p",[s._v("Redis默认是不开启的，需要使用时，需要配置： "),t("strong",[s._v("appendonly yes")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("策略")]),s._v(" "),t("th",[s._v("解释")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("appendfsync always")]),s._v(" "),t("td",[s._v("收到命令就立即写到磁盘,效率最慢.但是能保证完全的持久化")])]),s._v(" "),t("tr",[t("td",[s._v("appendfsync everysec")]),s._v(" "),t("td",[s._v("每秒写入磁盘一次,在性能和持久化方面做了很好的折中")])]),s._v(" "),t("tr",[t("td",[s._v("appendfsync no")]),s._v(" "),t("td",[s._v("完全以依赖os，一般同步周期是30秒")])])])]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111165540632.png",alt:""}})])]),s._v(" "),t("p",[t("strong",[s._v("优点:")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("AOF方式数据安全性更高，配置得当，最多损失1秒的数据量")])]),s._v(" "),t("li",[t("p",[s._v("在不小心执行flushall命令，也可以通过AOF方式恢复(删除最后一个命令即可)")])]),s._v(" "),t("li",[t("p",[s._v("AOF 日志是一个增量日志文件，不会存在断电时出现损坏问题。即使出现问题，Redis-check-aof 工具也能够轻松修复它。")])]),s._v(" "),t("li",[t("p",[s._v("当 AOF 变得太大时，Redis 能够在后台自动重写 AOF")])])]),s._v(" "),t("p",[t("strong",[s._v("缺点:")])]),s._v(" "),t("ul",[t("li",[s._v("相同数据量来说，AOF文件体积通常大于RDB文件")]),s._v(" "),t("li",[s._v("数据持久化性能上来说，AOF 比 RDB 慢")])]),s._v(" "),t("h3",{attrs:{id:"_9-3-rdb-aof混合方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-3-rdb-aof混合方式"}},[s._v("#")]),s._v(" 9.3 RDB-AOF混合方式")]),s._v(" "),t("p",[s._v("Redis 4.0之后，推出了混合持久化方式，他把RDB,AOF的优点集中起来，简单的说就是在你执行bgrewriteaof或触发自动AOF重写的时候，将AOF文件以RDB文件格式（二进制压缩）写到AOF文件中。而在下次重写之前，依然用aof文件格式追加到上面二进制数据的后面。注意： 开启它之前必须现开启AOF")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("aof-use-rdb-preamble yes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这样既可以让数据恢复时和RDB一样快速，又可以和AOF文件一样准确。兼顾了性能和安全性。")]),s._v(" "),t("p",[t("strong",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20240111165901039.png",alt:""}})])]),s._v(" "),t("h2",{attrs:{id:"十、redis内存淘汰机制-拓展"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十、redis内存淘汰机制-拓展"}},[s._v("#")]),s._v(" 十、Redis内存淘汰机制[拓展]")]),s._v(" "),t("h3",{attrs:{id:"_10-1-引言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-1-引言"}},[s._v("#")]),s._v(" 10.1 引言")]),s._v(" "),t("p",[s._v("Redis 启动会加载一个配置：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("maxmemory "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("byte"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   //内存上限\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("默认值为 0 (window版的限制为100M)，表示默认设置Redis内存上限。但是真实开发还是需要提前评估key的体量，提前设置好内容上限。")]),s._v(" "),t("p",[s._v("此时思考一个问题，开发中，在设置完内存上限之后，如果Redis key达到上限了，该怎么办？这就设置到Redis的内存淘汰机制了。")]),s._v(" "),t("h3",{attrs:{id:"_10-2-内存淘汰算法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-内存淘汰算法"}},[s._v("#")]),s._v(" 10.2 内存淘汰算法")]),s._v(" "),t("p",[s._v("Redis内存淘汰机制也可以称之为key内卷机制，当资源不足时，该如何选择？")]),s._v(" "),t("p",[s._v("常见的内存淘汰机制分为四大类：")]),s._v(" "),t("ul",[t("li",[s._v("**LRU：**LRU是Least recently used，最近最少使用的意思，简单的理解就是从数据库中删除最近最少访问的数据，该算法认为，你长期不用的数据，那么被再次访问的概率也就很小了，淘汰的数据为最长时间没有被使用，仅与时间相关。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20220902161050652.png",alt:""}})]),s._v(" "),t("ul",[t("li",[t("p",[s._v("**LFU：**LFU是Least Frequently Used，最不经常使用的意思，简单的理解就是淘汰一段时间内，使用次数最少的数据，这个与频次和时间相关。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20220902161057116.png",alt:""}})])]),s._v(" "),t("li",[t("p",[s._v("**TTL：**Redis中，有的数据是设置了过期时间的，而设置了过期时间的这部分数据，就是该算法要解决的对象。如果你快过期了，不好意思，我内存现在不够了，反正你也要退休了，提前送你一程，把你干掉吧。")])]),s._v(" "),t("li",[t("p",[s._v("随机淘汰：生死有命，富贵在天，是否被干掉，全凭天意了。")])])]),s._v(" "),t("h3",{attrs:{id:"_10-3-redis淘汰策略"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-3-redis淘汰策略"}},[s._v("#")]),s._v(" 10.3 Redis淘汰策略")]),s._v(" "),t("p",[s._v("Redis 通过配置")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("maxmemroy-policy  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("来配置指定具体的淘汰机制，可供选择的值有：")]),s._v(" "),t("p",[s._v("通过maxmemroy-policy可以配置具体的淘汰机制，看了网上很多文章说只有6种，其实有8种，可以看Redis5.0的配置文件，上面有说明：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("volatile-lru -> 找出已经设置过期时间的数据集，将最近最少使用（被访问到）的数据干掉。")])]),s._v(" "),t("li",[t("p",[s._v("volatile-ttl -> 找出已经设置过期时间的数据集，将即将过期的数据干掉。")])]),s._v(" "),t("li",[t("p",[s._v("volatile-random -> 找出已经设置过期时间的数据集，进行无差别攻击，随机干掉数据。")])]),s._v(" "),t("li",[t("p",[s._v("volatile-lfu -> 找出已经设置过期时间的数据集，将一段时间内，使用次数最少的数据干掉。")])]),s._v(" "),t("li",[t("p",[s._v("allkeys-lru ->与第1个差不多，数据集从设置过期时间数据变为全体数据。")])]),s._v(" "),t("li",[t("p",[s._v("allkeys-lfu -> 与第4个差不多，数据集从设置过期时间数据变为全体数据。")])]),s._v(" "),t("li",[t("p",[s._v("allkeys-random -> 与第3个差不多，数据集从设置过期时间数据变为全体数据。")])]),s._v(" "),t("li",[t("p",[s._v("no-enviction -> 什么都不干，报错，告诉你内存不足，这样的好处是可以保证数据不丢失")])])]),s._v(" "),t("p",[t("strong",[s._v("系统默认选择： noenviction")])]),s._v(" "),t("h2",{attrs:{id:"十一、过期key处理-拓展"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十一、过期key处理-拓展"}},[s._v("#")]),s._v(" 十一、过期Key处理[拓展]")]),s._v(" "),t("p",[s._v("接下讨论一个问题：Redis的key过期了，该如何清理问题。")]),s._v(" "),t("p",[s._v("Redis给出3种实现方案：")]),s._v(" "),t("p",[t("strong",[s._v("惰性删除")]),s._v("：当访问Key时，才去判断它是否过期，如果过期，直接干掉。这种方式对CPU很友好，但是一个key如果长期不用，一直存在内存里，会造成内存浪费。")]),s._v(" "),t("p",[t("strong",[s._v("定时删除")]),s._v("：设置键的过期时间的同时，创建一个定时器，当到达过期时间点，立即执行对Key的删除操作，这种方式对CPU不友好，得额外让出CPU维护定时器。")]),s._v(" "),t("p",[t("strong",[s._v("定期删除")]),s._v("：隔一段时间，对数据进行一次检查，删除里面的过期Key，至于要删除多少过期Key，检查多少数据，则由算法决定。")]),s._v(" "),t("p",[t("strong",[s._v("Redis服务器实际使用的是惰性删除和定期删除两种策略：通过配合使用这两种删除策略，可以很好地在合理使用CPU和避免浪费内存之间取得平衡。")])]),s._v(" "),t("h2",{attrs:{id:"十二、小结与作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十二、小结与作业"}},[s._v("#")]),s._v(" 十二、小结与作业")]),s._v(" "),t("h3",{attrs:{id:"_12-1-小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_12-1-小结"}},[s._v("#")]),s._v(" 12.1 小结")]),s._v(" "),t("ul",[t("li",[s._v("掌握Redis基本数据结构")]),s._v(" "),t("li",[s._v("掌握Redis常用命令")]),s._v(" "),t("li",[s._v("了解Redis事务")]),s._v(" "),t("li",[s._v("了解Redis持久化机制")]),s._v(" "),t("li",[s._v("了解Redis内存淘汰机制")]),s._v(" "),t("li",[s._v("了解Redis key过期处理机制")])]),s._v(" "),t("h3",{attrs:{id:"_12-2-作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_12-2-作业"}},[s._v("#")]),s._v(" 12.2 作业")]),s._v(" "),t("ul",[t("li",[s._v("命令5遍")]),s._v(" "),t("li",[s._v("小案例")])]),s._v(" "),t("p",[s._v("类似效果：https://www.mafengwo.cn/gonglve/ziyouxing/2339.html")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/langfeiyes/images-khub/image-20220902213752150.png",alt:""}})])])}),[],!1,null,null,null);t.default=n.exports}}]);